<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Sugestões</title>
</head>
<body>

<h1>Sugestões</h1>

<p>Conexão: <span id="conexaoId">-</span> | Página: <span id="paginaInfo">-</span></p>

<ul id="lista"></ul>

<button id="prev">Anterior</button>
<button id="next">Próxima</button>

<br><br>

<form id="form">
    <input type="text" id="campo" placeholder="Digite a sugestão" required>
    <button type="submit">Enviar</button>
</form>

<p id="msg" style="color:green; display:none;"></p>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();

const ul = document.getElementById("lista");
const msg = document.getElementById("msg");
const conexaoId = document.getElementById("conexaoId");
const paginaInfo = document.getElementById("paginaInfo");


socket.on("estado", (data) => {
    conexaoId.textContent = data.id;
    paginaInfo.textContent = data.paginaAtual;
});


socket.on("lista", (data) => {
    ul.innerHTML = "";
    data.itens.forEach(s => {
        const li = document.createElement("li");
        li.textContent = s.texto;
        ul.appendChild(li);
    });

    paginaInfo.textContent = data.page + " de " + data.totalPages;
});


socket.on("criada", (data) => {
    msg.textContent = data.mensagem;
    msg.style.display = "block";
    setTimeout(() => msg.style.display = "none", 2000);
});


document.getElementById("form").addEventListener("submit", (e) => {
    e.preventDefault();
    const texto = document.getElementById("campo").value.trim();
    if (texto) {
        socket.emit("criar", texto);
        document.getElementById("campo").value = "";
    }
});


document.getElementById("prev").onclick = () => {
    socket.emit("mudarPagina", "anterior");
};

document.getElementById("next").onclick = () => {
    socket.emit("mudarPagina", "proxima");
};
</script>

</body>
</html>
